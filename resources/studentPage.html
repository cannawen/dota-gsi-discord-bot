<html>
    <head>
        <title>Wow so fancy</title>
        <script>
            function fetchAndPlay() {
                return fetch("./poll")
                    .then((res) => res.json())
                    .then((res) => {
                        return new Promise((resolve) => {
                            if (res[0]) {
                                const f = new Audio("/" + res[0]);
                                f.addEventListener("ended", resolve);
                                f.play();
                            } else {
                                resolve();
                            }
                        });
                    });
            }

            function loop() {
                fetchAndPlay().then(() => setTimeout(loop, 500));
            }
        </script>
    </head>
    <body>
        <button onClick="loop()">START COACHING</button>
    </body>
</html>
